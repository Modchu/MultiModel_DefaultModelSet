package modchu.model;import java.lang.reflect.Field;import java.util.ArrayList;import java.util.List;import java.util.Map.Entry;import java.util.concurrent.ConcurrentHashMap;import modchu.lib.Modchu_AS;import modchu.lib.Modchu_CastHelper;import modchu.lib.Modchu_Debug;import modchu.lib.Modchu_EntityCapsBase;import modchu.lib.Modchu_IEntityCapsBase;import modchu.lib.Modchu_Main;import modchu.lib.Modchu_Reflect;import modchu.model.multimodel.base.MultiModelAction;import modchu.model.multimodel.base.MultiModelBaseBiped;public class ModchuModel_ModelDataBase extends Modchu_EntityCapsBase implements ModchuModel_IEntityCaps {	public static int allMultiModelActionMode = 0;	public static int allMultiModelActionRequestNumber = 0;	public static final int allMultiModelActionModeMax = 2;	public static final int allMultiModelActionMax = 30;	public static boolean allMultiModelActionFlag = false;	private Object subEntityCaps;	protected String textureName = null;	protected String modelArmorName = null;	protected int maidColor = 0;	private boolean isSitting = false;	private boolean[] actionRequest = new boolean[3];	private boolean[] actionAllRequest = new boolean[3];	private boolean actionFlag = false;	private boolean actionAllFlag = false;	private boolean motionResetFlag = false;	private boolean motionSetFlag = false;	private boolean sleeping = false;	private boolean allMultiModelActionRunFlag = false;	private float actionSpeed = 0.0F;	private float actionAllSpeed = 0.0F;	private int skinMode = 0;	private int runActionNumber = 0;	private int runAllActionNumber = 0;	private int actionRequestNumber = 0;	private int allActionRequestNumber = 0;	private int actionReleaseNumber = 0;	private int actionAllReleaseNumber = 0;	private int actionCount = 0;	private int actionAllCount = 0;	private float actionTime = 0F;	private float actionAllTime = 0F;	private int initFlag = 0;	private byte entityType = 1;	private List<String> showPartsHideList = new ArrayList();	private ConcurrentHashMap<String, String> showPartsRenemeMap = new ConcurrentHashMap();	private ConcurrentHashMap<String, Object> freeVariableMap;	private boolean allMultiModelActionRunInitFlag;	public ModchuModel_ModelDataBase() {		super(null);	}	@Override	public Object getCapsValue(int pIndex, Object ... pArg) {		return getCapsValue(null, pIndex, pArg);	}	@Override	public Object getCapsValue(Modchu_IEntityCapsBase model, int pIndex, Object... pArg) {		switch (pIndex) {		case caps_EntityType:			return getEntityType();		case caps_textureName:			return getTextureName();		case caps_textureArmorName:			return getTextureArmorName();		case caps_maidColor:			return getMaidColor();		case caps_subEntityCaps:			return getSubEntityCaps();		case caps_isSitting:			return getIsSitting();		case caps_isSleeping:			return getIsSleeping();		case caps_initFlag:			return getInitFlag();		case caps_height:			return Modchu_AS.getFloat(Modchu_AS.entityHeight, getOwner());		case caps_width:			return Modchu_AS.getFloat(Modchu_AS.entityWidth, getOwner());		case caps_actionRequest:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				return getActionRequest((Boolean) pArg[0]);			}			return getActionRequest();		case caps_actionRequestNumber:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				return getActionRequestNumber((Boolean) pArg[0]);			}			return getActionRequestNumber();		case caps_runActionNumber:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				return getActionRequestNumber((Boolean) pArg[0]);			}			return getActionRequestNumber();		case caps_actionReleaseNumber:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				return getActionRequestNumber((Boolean) pArg[0]);			}			return getActionRequestNumber();		case caps_actionFlag:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				return getActionFlag((Boolean) pArg[0]);			}			return getActionFlag();		case caps_actionCount:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				return getActionCount((Boolean) pArg[0]);			}			return getActionCount();		case caps_actionTime:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				return getActionTime((Boolean) pArg[0]);			}			return getActionTime();		case caps_actionSpeed:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				return getActionSpeed((Boolean) pArg[0]);			}			return getActionSpeed();		case caps_skinMode:			return getSkinMode();		case caps_motionResetFlag:			return getMotionResetFlag();		case caps_motionSetFlag:			return getMotionSetFlag();		case caps_showPartsHideList:			return getShowPartsHideList();		case caps_showPartsRenemeMap:			return getShowPartsRenemeMap();		case caps_allMultiModelActionMode:			return getAllMultiModelActionMode();		case caps_allMultiModelActionModeMax:			return getAllMultiModelActionModeMax();		case caps_allMultiModelActionRequestNumber:			return getAllMultiModelActionRequestNumber();		case caps_allMultiModelActionFlag:			return getAllMultiModelActionFlag();		case caps_allMultiModelActionMax:			return getAllMultiModelActionMax();		case caps_allMultiModelActionRunInitFlag:			return getAllMultiModelActionRunInitFlag();		case caps_firstPerson:			return getFirstPerson();		case caps_oldwalking:			return getOldwalking();		case caps_showPartsMap:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) return getShowPartsMap((Integer) pArg[0]);			break;		case caps_showPartsMapBoolean:			if (pArg != null			&& pArg.length > 1			&& pArg[0] != null			&& pArg[1] != null) {				return getShowPartsMapBoolean((String) pArg[0], (Integer) pArg[1]);			}			break;		case caps_showModelSettingBoolean:			if (pArg != null			&& pArg.length > 1			&& pArg[0] != null			&& pArg[1] != null) return getShowModelSettingBoolean((ModchuModel_ModelRenderer) pArg[0], (Integer) pArg[1]);			return true;		case caps_freeVariable:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				return getFreeVariable((String)pArg[0]);			}			break;		case caps_model:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) return getModel((Integer) pArg[0]);			break;		case caps_texture:			if (pArg != null			&& pArg.length > 1			&& pArg[0] != null			&& pArg[1] != null) return getTexture((String) pArg[0], (Integer) pArg[1]);			break;		case caps_armorTexture:			if (pArg != null			&& pArg.length > 1			&& pArg[0] != null			&& pArg[1] != null) {				if (pArg.length > 2) {					return getArmorTexture((String) pArg[0], (Integer) pArg[1], pArg[2]);				}				return getArmorTexture((String) pArg[0], (Integer) pArg[1]);			}			break;		case caps_isCamouflage:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				return Modchu_AS.getBoolean(Modchu_AS.isCamouflage, pArg[0]);			}/*			boolean b = Modchu_AS.getBoolean(Modchu_AS.isCamouflage, getCapsValue(caps_HeadMount, 9));			if (b) return b;			Object itemStack = getCapsValue(caps_currentArmor, 3);			b = Modchu_AS.getBoolean(Modchu_AS.isPumpkin, itemStack);			if (b) return b;			return Modchu_AS.getBoolean(Modchu_AS.isSkull, itemStack);*/			return false;		case caps_isPlanter:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				return Modchu_AS.getBoolean(Modchu_AS.isPlanter, pArg[0]);			}			return Modchu_AS.getBoolean(Modchu_AS.isPlanter, getCapsValue(caps_HeadMount, 9));		}		Object o = null;		if (model != null) {			if (model instanceof ModchuModel_ModelDataBase) {				String s = "model instanceof ModchuModel_ModelDataBase [ERROR] !! model="+model;				Modchu_Debug.Debug(s);				Modchu_Debug.calledFrom();				Modchu_Main.setRuntimeException(s);			} else {				o = model.getCapsValue(this, pIndex, (Object[]) pArg);			}		}		if (o != null) return o;		if (subEntityCaps != null) {			o = Modchu_Reflect.invokeMethod(subEntityCaps.getClass(), "getCapsValue", new Class[]{ int.class, Object[].class }, subEntityCaps, new Object[]{ pIndex, pArg });			return o;		}		return super.getCapsValue(pIndex, pArg);	}	@Override	public boolean setCapsValue(int pIndex, Object... pArg) {		return setCapsValue(null, pIndex, pArg);	}	@Override	public boolean setCapsValue(Modchu_IEntityCapsBase model, int pIndex, Object... pArg) {		switch (pIndex) {		case caps_Entity:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				setEntity(pArg[0]);				return true;			}			return false;		case caps_textureName:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				setTextureName((String) pArg[0]);				return true;			}			return false;		case caps_textureArmorName:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				setTextureArmorName((String) pArg[0]);				return true;			}			return false;		case caps_maidColor:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				setMaidColor((Integer) pArg[0]);				return true;			}			return false;		case caps_subEntityCaps:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				setSubEntityCaps(pArg[0]);				return true;			}			return false;		case caps_skinMode:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				setSkinMode((Integer) pArg[0]);				return true;			}			return false;		case caps_isSitting:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				setIsSitting((Boolean) pArg[0]);				return true;			}			return false;		case caps_isSleeping:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				setIsSleeping((Boolean) pArg[0]);				return true;			}			return false;		case caps_initFlag:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				setInitFlag((Integer) pArg[0]);				return true;			}			return false;		case caps_EntityType:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				setEntityType((Byte) pArg[0]);				return true;			}			return false;		case caps_actionRequest:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				setActionRequest((boolean[]) pArg[0]);				return true;			}			return false;		case caps_freeVariable:			if (pArg != null			&& pArg.length > 1			&& pArg[0] != null) {				setFreeVariable((String)pArg[0], pArg[1]);				return true;			}			return false;		case caps_actionRequestNumber:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				if (pArg.length > 1						&& pArg[1] != null) {					setActionRequestNumber((Integer) pArg[0], (Boolean) pArg[1]);					return true;				}				setActionRequestNumber((Integer) pArg[0]);				return true;			}			return false;		case caps_actionReleaseNumber:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				if (pArg.length > 1						&& pArg[1] != null) {					setActionReleaseNumber((Integer) pArg[0], (Boolean) pArg[1]);					return true;				}				setActionReleaseNumber((Integer) pArg[0]);				return true;			}			return false;		case caps_actionCount:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				if (pArg.length > 1						&& pArg[1] != null) {					setActionCount((Integer) pArg[0], (Boolean) pArg[1]);					return true;				}				setActionCount((Integer) pArg[0]);				return true;			}			return false;		case caps_actionTime:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				if (pArg.length > 1						&& pArg[1] != null) {					setActionTime((Float) pArg[0], (Boolean) pArg[1]);					return true;				}				setActionTime((Float) pArg[0]);				return true;			}			return false;		case caps_actionFlag:			return false;		case caps_actionSpeed:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				if (pArg.length > 1						&& pArg[1] != null) {					setActionSpeed((Float) pArg[0], (Boolean) pArg[1]);					return true;				}				setActionSpeed((Float) pArg[0]);				return true;			}			return false;		case caps_motionResetFlag:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				setMotionResetFlag((Boolean) pArg[0]);				return true;			}			return false;		case caps_motionSetFlag:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				setMotionSetFlag((Boolean) pArg[0]);				return true;			}			return false;		case caps_showPartsHideList:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				addShowPartsHideList((String[]) pArg[0]);				return true;			}			return false;		case caps_showPartsRenemeMap:			if (pArg != null			&& pArg.length > 1			&& pArg[0] != null			&& pArg[1] != null) {				addShowPartsRenemeMap((String[]) pArg[0], (String[]) pArg[1]);				return true;			}			return false;		case caps_actionInit:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				actionInit((Integer) pArg[0]);				return true;			}			return false;		case caps_actionRelease:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				actionRelease((Integer) pArg[0]);				return true;			}			return false;		case caps_setRotationAnglesBefore:			if (pArg != null			&& pArg.length > 6			&& pArg[0] != null			&& pArg[1] != null			&& pArg[2] != null			&& pArg[3] != null			&& pArg[4] != null			&& pArg[5] != null			&& pArg[6] != null) {				setRotationAnglesBefore((MultiModelBaseBiped) pArg[0], (Float) pArg[1] ,(Float) pArg[2], (Float) pArg[3], (Float) pArg[4], (Float) pArg[5], (Float) pArg[6]);				return true;			}			return false;		case caps_setRotationAnglesAfter:			if (pArg != null			&& pArg.length > 6			&& pArg[0] != null			&& pArg[1] != null			&& pArg[2] != null			&& pArg[3] != null			&& pArg[4] != null			&& pArg[5] != null			&& pArg[6] != null) {				setRotationAnglesAfter((MultiModelBaseBiped) pArg[0], (Float) pArg[1] ,(Float) pArg[2], (Float) pArg[3], (Float) pArg[4], (Float) pArg[5], (Float) pArg[6]);				return true;			}			return false;		case caps_allMultiModelActionMode:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				setAllMultiModelActionMode((Integer) pArg[0]);				return true;			}			return false;		case caps_allMultiModelActionRequestNumber:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				setAllMultiModelActionRequestNumber((Integer) pArg[0]);				return true;			}			return false;		case caps_allMultiModelActionFlag:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				setAllMultiModelActionFlag((Boolean) pArg[0]);				return true;			}			return false;		case caps_oldwalking:			if (pArg != null && pArg.length > 0 && pArg[0] != null) {				setOldwalking((Boolean) pArg[0]);				return true;			}			return false;		case caps_firstPerson:			if (pArg != null && pArg.length > 0 && pArg[0] != null) {				setFirstPerson((Boolean) pArg[0]);				return true;			}			return false;/*		case caps_showPartsNemeMap:			if (pArg != null			&& pArg.length > 1			&& pArg[0] != null			&& pArg[1] != null) {				setShowPartsNemeMap((Integer) pArg[0], (String) pArg[1]);				return true;			}*/		case caps_indexOfAllVisible:			if (pArg != null			&& pArg.length > 1			&& pArg[0] != null			&& pArg[1] != null) {				if (pArg.length > 2						&& pArg[2] != null) indexOfAllSetVisible((String) pArg[0], (Integer) pArg[1], (Boolean) pArg[2]);				else indexOfAllSetVisible((String) pArg[0], (Integer) pArg[1]);				return true;			}			return false;		case caps_showModelSettingReflects:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				showModelSettingReflects((Integer) pArg[0]);				return true;			}			return false;		case caps_defaultShowPartsMap:			if (pArg != null			&& pArg.length > 1			&& pArg[0] != null			&& pArg[1] != null) return getDefaultShowPartsMapBoolean((String) pArg[0], (Integer) pArg[1]);			break;		case caps_allMultiModelActionRunInitFlag:			if (pArg != null			&& pArg.length > 0			&& pArg[0] != null) {				setAllMultiModelActionRunInitFlag((Boolean) pArg[0]);				return true;			}			return false;		}		if (subEntityCaps != null) {			return (Boolean) (Modchu_Reflect.invokeMethod(subEntityCaps.getClass(), "setCapsValue", new Class[]{ int.class, Object[].class }, subEntityCaps, new Object[]{ pIndex, pArg }));		}		return super.setCapsValue(pIndex, pArg);	}	/**	 * setRotationAnglesLM 呼び出し前に呼ばれる。	 */	protected void setRotationAnglesBefore(MultiModelBaseBiped model, float f, float f1, float f2, float f3, float f4, float f5) {	}	/**	 * setRotationAnglesLM 呼び出し後に呼ばれる。	 */	protected void setRotationAnglesAfter(MultiModelBaseBiped model, float f, float f1, float f2, float f3, float f4, float f5) {		if (model != null				&& model instanceof MultiModelAction); else {			model.boneProcessing(f, f1, f2, f3, f4, f5, this);			//Modchu_Debug.mDebug("setRotationAnglesAfter else");			return;		}		setRotationAnglesAfterAllMultiModelActionSetting(model, f, f1, f2, f3, f4, f5);		setRotationAnglesAfterActionSetting(model, f, f1, f2, f3, f4, f5);	}	private void setRotationAnglesAfterAllMultiModelActionSetting(MultiModelBaseBiped model, float f, float f1, float f2, float f3, float f4, float f5) {		boolean allMultiModelActionFlag = getAllMultiModelActionFlag();		if (allMultiModelActionFlag				&& getAllMultiModelActionModeCheck()) {			int allMultiModelActionRequestNumber = getAllMultiModelActionRequestNumber();			//Modchu_Debug.mDebug("setRotationAnglesAfterAllMultiModelActionSetting allMultiModelActionRequestNumber="+allMultiModelActionRequestNumber);			if (allMultiModelActionRequestNumber > 0) {				if (getActionRequestNumber(allMultiModelActionFlag) != allMultiModelActionRequestNumber) {					setActionRequestNumber(allMultiModelActionRequestNumber, allMultiModelActionFlag);				}				if (allMultiModelActionRunInitFlag) {					setActionRequest(new boolean[]{ true, true, allMultiModelActionFlag });					allMultiModelActionRunFlag = true;					allMultiModelActionRunInitFlag = false;				}			}		} else {			if (!allMultiModelActionRunInitFlag) allMultiModelActionRunInitFlag = true;			if (allMultiModelActionRunFlag) {				setActionRequest(new boolean[]{ true, false, true });				allMultiModelActionRunFlag = false;			}		}	}	private void setRotationAnglesAfterActionSetting(MultiModelBaseBiped model, float f, float f1, float f2, float f3, float f4, float f5) {		if (!setRotationAnglesAfterActionSettingActionRequestSetting(model, f, f1, f2, f3, f4, f5, true)) setRotationAnglesAfterActionSettingActionRequestSetting(model, f, f1, f2, f3, f4, f5, false);		boolean allAction = getAllMultiModelActionFlag();		int runActionNumber = getRunActionNumber(allAction);		//Modchu_Debug.mDebug("setRotationAnglesAfterActionSetting 1 runActionNumber="+runActionNumber);		if (getActionFlag(allAction)				&& !getResetActionNumberFlag(allAction)				&& runActionNumber > 0) {			//Modchu_Debug.mDebug("setRotationAnglesAfterActionSetting 2 runActionNumber="+runActionNumber);			if (!getCapsValueBoolean(caps_isPlayer)) setActionReleaseNumber(runActionNumber, allAction);			float actionSpeed = ModchuModel_ModelDataMaster.instance.getActionSpeed(this, f2);			setActionSpeed(actionSpeed, allAction);			//Modchu_Debug.mDebug("setRotationAnglesAfterActionSetting actionSpeed="+actionSpeed);			Object[] model2 = getTextureDataModel();			if (model2 != null) {				for (int i = 0; i < model2.length; i++) {					Object o = Modchu_Main.getModchuCharacteristicObjectMaster(model2[i]);					MultiModelBaseBiped model3 = o != null ? (MultiModelBaseBiped) o : null;					if (model3 != null); else {						//Modchu_Debug.mDebug("setRotationAnglesAfterActionSetting model3 == null !!");						if (i == 0) {							if (MultiModelAction.class.isInstance(model)) {								((MultiModelAction) model).action(f, f1, f2, f3, f4, f5, runActionNumber, this);								Modchu_Debug.mDebug("setRotationAnglesAfterActionSetting model3 == null !! model.action call");							} else {								//Modchu_Debug.mDebug("setRotationAnglesAfterActionSetting model3 == null !! model != MultiModelAction !!");							}							model.boneProcessing(f, f1, f2, f3, f4, f5, this);						}						continue;					}					if (MultiModelAction.class.isInstance(model3)) {						((MultiModelAction) model3).action(f, f1, f2, f3, f4, f5, runActionNumber, this);						//Modchu_Debug.mDebug("setRotationAnglesAfterActionSetting model3.action call");					} else {						//Modchu_Debug.mDebug("setRotationAnglesAfterActionSetting model3 !MultiModelAction.class.isInstance !!");					}					model3.boneProcessing(f, f1, f2, f3, f4, f5, this);				}			} else {				model.boneProcessing(f, f1, f2, f3, f4, f5, this);			}			setActionSpeed(0.0F, allAction);		} else {			actionReleaseRun(allAction);			model.boneProcessing(f, f1, f2, f3, f4, f5, this);		}	}	private boolean setRotationAnglesAfterActionSettingActionRequestSetting(MultiModelBaseBiped model, float f, float f1, float f2, float f3, float f4, float f5, boolean b) {		boolean[] b1;		boolean isRequest;		boolean isAction;		boolean allAction = false;		b1 = getActionRequest(b);		isRequest = b1 != null ? b1[0] : false;		isAction = b1 != null				&& b1.length > 1 ? b1[1] : false;		allAction = b1 != null				&& b1.length > 2 ? b1[2] : false;		//boolean debug = !isEntityPlayer(getOwner());		boolean debug = false;		if (debug) Modchu_Debug.mDebug("setRotationAnglesAfterActionSettingActionRequestSetting getActionRequest() isRequest="+isRequest+" isAction="+isAction+" allAction="+allAction+" getOwner()="+getOwner()+" this="+this);		if (isRequest) {			if (debug) Modchu_Debug.mDebug("setRotationAnglesAfterActionSettingActionRequestSetting getActionRequest() isRequest=true isAction="+isAction+" allAction="+allAction);			int runActionNumber = getRunActionNumber(allAction);			if (debug) Modchu_Debug.mDebug("setRotationAnglesAfterActionSettingActionRequestSetting runActionNumber="+runActionNumber);			if (isAction) {				if (debug) Modchu_Debug.mDebug("setRotationAnglesAfterActionSettingActionRequestSetting ActionRequest action実行処理");				int actionRequestNumber = getActionRequestNumber(allAction);				if (debug) Modchu_Debug.mDebug("setRotationAnglesAfterActionSettingActionRequestSetting 1 actionRequestNumber="+actionRequestNumber);				if (actionRequestNumber > 0						&& actionRequestNumber != runActionNumber) {					if (debug) Modchu_Debug.mDebug("setRotationAnglesAfterActionSettingActionRequestSetting 2 actionRequestNumber="+actionRequestNumber);					if (!getResetActionNumberFlag(allAction)) {						if (debug) Modchu_Debug.mDebug("setRotationAnglesAfterActionSettingActionRequestSetting 3 setActionFlag");						setActionFlag(true, allAction);					}					setRunActionNumber(actionRequestNumber, allAction);					if (debug) Modchu_Debug.mDebug("setRotationAnglesAfterActionSettingActionRequestSetting 4");				}			} else {				if (debug) Modchu_Debug.mDebug("setRotationAnglesAfterActionSettingActionRequestSetting ActionRequest action解除処理");				if (!getResetActionNumberFlag(allAction)) {					if (debug) Modchu_Debug.mDebug("setRotationAnglesAfterActionSettingActionRequestSetting ActionRequest 1 setActionFlag");					setActionFlag(false, allAction);				}				if (setRunActionNumber(0, allAction)) {					if (debug) Modchu_Debug.mDebug("setRotationAnglesAfterActionSettingActionRequestSetting ActionRequest 2 setActionRequestNumber");					setActionRequestNumber(0, allAction);				}				if (debug) Modchu_Debug.mDebug("setRotationAnglesAfterActionSettingActionRequestSetting ActionRequest 3");				setActionRequest(new boolean[]{ false, false, false });			}			if (debug) Modchu_Debug.mDebug("setRotationAnglesAfterActionSettingActionRequestSetting end.");		} else {			return getAllMultiModelActionFlag();		}		return allAction;	}	private void actionInit(int i) {		//Modchu_Debug.mDebug("ModchuModel_ModelDataBase 1 actionInit i="+i);		Object[] model2 = getTextureDataModel();		if (model2 != null) {			//Modchu_Debug.mDebug("ModchuModel_ModelDataBase actionInit 2 model2 != null");			for (int i1 = 0; i1 < model2.length; i1++) {				Object model3 = Modchu_Main.getModchuCharacteristicObjectMaster(model2[i1]);				if (model3 != null); else {					//Modchu_Debug.mDebug("ModchuModel_ModelDataBase actionInit 3 model3 == null !! continue");					continue;				}				if (MultiModelAction.class.isInstance(model3)) {					((MultiModelAction) model3).actionInit(this, i);					//Modchu_Debug.mDebug("ModchuModel_ModelDataBase actionInit 4 actionInit call.");				} else {					Modchu_Debug.systemLogDebug("ModchuModel_ModelDataBase actionInit model2 !MultiModelAction.class.isInstance !!");				}			}		}	}	private void actionRelease(int i) {		Object[] model2 = getTextureDataModel();		if (model2 != null) {			for (int i1 = 0; i1 < model2.length; i1++) {				Object o = Modchu_Main.getModchuCharacteristicObjectMaster(model2[i1]);				MultiModelBaseBiped model3 = o != null ? (MultiModelBaseBiped) o : null;				if (model3 != null); else continue;				if (MultiModelAction.class.isInstance(model3)) {					((MultiModelAction) model3).actionRelease(this, i);				} else {					Modchu_Debug.systemLogDebug("actionRelease model2 !MultiModelAction.class.isInstance !!");				}			}		}	}	protected Object[] getTextureDataModel() {		Object entity = Modchu_Reflect.invokeMethod(subEntityCaps.getClass(), "getCapsValue", new Class[]{ int.class, Object[].class }, subEntityCaps, new Object[]{ caps_Entity, null });		if (entity != null) {			Object textureData = Modchu_Reflect.getFieldObject(entity.getClass(), "textureData", entity);			if (textureData != null) {				return (Object[]) Modchu_Reflect.getFieldObject(textureData.getClass(), "textureModel", textureData);			}		}		return null;	}	private void setEntity(Object entity) {		Modchu_Reflect.setFieldObject(ModchuModel_ModelDataBase.class, "owner", this, entity);	}	private Object getSubEntityCaps() {		return subEntityCaps;	}	protected void setSubEntityCaps(Object entityCaps) {		subEntityCaps = entityCaps;	}	protected boolean getMotionResetFlag() {		return motionResetFlag;	}	protected void setMotionResetFlag(boolean b) {		motionResetFlag = b;	}	protected boolean getIsSitting() {		return isSitting;	}	protected void setIsSitting(boolean b) {		isSitting = b;	}	protected boolean getIsSleeping() {		Object owner = getOwner();		return (owner != null				&& isEntityPlayer(owner)				&& Modchu_AS.getBoolean(Modchu_AS.entityPlayerIsPlayerSleeping, owner))				| sleeping;	}	protected void setIsSleeping(boolean b) {		sleeping = b;	}	protected boolean[] getActionRequest() {		return getActionRequest(getAllMultiModelActionFlag());	}	protected boolean[] getActionRequest(boolean allAction) {		//Modchu_Debug.mDebug("ModchuModel_ModelDataBase getActionRequest getOwner()="+getOwner());		//Modchu_Debug.mDebug("ModchuModel_ModelDataBase getActionRequest this="+this);		return allAction ? actionAllRequest : actionRequest;	}	protected void setActionRequest(boolean... b) {		//Modchu_Debug.mDebug("ModchuModel_ModelDataBase setActionRequest getOwner()="+getOwner());		if (b != null				&& b.length > 2				&& b[2]) {			actionAllRequest = b;		} else {			actionRequest = b;		}		//Modchu_Debug.mDebug("ModchuModel_ModelDataBase setActionRequest this="+this);		//Modchu_Debug.mDebug("ModchuModel_ModelDataBase setActionRequest actionRequest="+actionRequest+" actionRequest[0]="+actionRequest[0]+" actionRequest[1]="+actionRequest[1]);	}	protected void resetActionRequest(boolean b) {		if (b) {			actionAllRequest = null;		} else {			actionRequest = null;		}	}	protected int getActionRequestNumber() {		return getActionRequestNumber(getAllMultiModelActionFlag());	}	protected int getActionRequestNumber(boolean allAction) {		return allAction ? allActionRequestNumber : actionRequestNumber;	}	protected void setActionRequestNumber(int i) {		setActionRequestNumber(i, getAllMultiModelActionFlag());	}	protected void setActionRequestNumber(int i, boolean allAction) {		if (allAction				&& allActionRequestNumber != i) {			allActionRequestNumber = i;			//Modchu_Debug.mDebug("setActionRequestNumber i="+i);		}		else if (!allAction				&& actionRequestNumber != i) {			actionRequestNumber = i;			//Modchu_Debug.mDebug("setActionRequestNumber i="+i);		} else {			//Modchu_Debug.mDebug("setActionRequestNumber else i="+i);		}	}	protected int getRunActionNumber(boolean allAction) {		int i = allAction ? runAllActionNumber : runActionNumber;		//Modchu_Debug.mDebug("getRunActionNumber 1 i="+i+" allAction="+allAction);		if (i != getActionReleaseNumber(allAction)) {			Modchu_Debug.mDebug("getRunActionNumber 2 ! "+(getActionReleaseNumber(allAction)));			actionReleaseRun(allAction);			setActionReleaseNumber(i, allAction);		}		//Modchu_Debug.mDebug("getRunActionNumber end.");		return i;	}	protected boolean setRunActionNumber(int i, boolean allAction) {		//Modchu_Debug.mDebug("setRunActionNumber 1 i="+i+" allAction="+allAction);		if (allAction				&& runAllActionNumber != i) {			//Modchu_Debug.mDebug("setRunActionNumber 2 i="+i+" allAction="+allAction);			actionReleaseRun(allAction);			runAllActionNumber = i;			setActionReleaseNumber(i, allAction);			setActionRequest(new boolean[]{ false, false, allAction });			return true;		}		if (!allAction					&& runActionNumber != i) {			//Modchu_Debug.mDebug("setRunActionNumber 3 i="+i+" allAction="+allAction);			actionReleaseRun(allAction);			runActionNumber = i;			setActionReleaseNumber(i, allAction);			setActionRequest(new boolean[]{ false, false, allAction });			return true;		}		return false;	}	protected int getActionReleaseNumber(boolean allAction) {		return allAction ? actionAllReleaseNumber : actionReleaseNumber;	}	protected void setActionReleaseNumber(int i) {		setActionReleaseNumber(i, getAllMultiModelActionFlag());	}	protected void setActionReleaseNumber(int i, boolean allAction) {		//Modchu_Debug.mDebug("setActionReleaseNumber 1 i="+i+" allAction="+allAction);		if (allAction				&& i != actionAllReleaseNumber) {			//Modchu_Debug.mDebug("setActionReleaseNumber 2 i="+i+" allAction="+allAction);			actionAllReleaseNumber = i;		}		else if (!allAction				&& i != actionReleaseNumber) {			//Modchu_Debug.mDebug("setActionReleaseNumber 3 i="+i+" allAction="+allAction);			actionReleaseNumber = i;		}	}	protected boolean getResetActionNumberFlag(boolean allAction) {		return false;	}	protected void setResetActionNumberFlag(boolean b, boolean allAction) {	}	protected void actionReleaseRun(boolean allAction) {		int i = getActionReleaseNumber(allAction);		actionReleaseRun(i, allAction);	}	protected void actionReleaseRun(int i, boolean allAction) {		//Modchu_Debug.mDebug("actionReleaseRun() 1 i="+i+" allAction="+allAction);		if (i > 0) {			Modchu_Debug.mDebug("actionReleaseRun() 2 i="+i+" allAction="+allAction);			setCapsValue(caps_actionRelease, i);			setActionReleaseNumber(0, allAction);		}	}	protected boolean getActionFlag() {		return getActionFlag(getAllMultiModelActionFlag());	}	protected boolean getActionFlag(boolean allAction) {		return allAction ? actionAllFlag : actionFlag;	}	protected void setActionFlag(boolean b, boolean allAction) {		if (allAction) {			actionAllFlag = b;		} else {			actionFlag = b;		}	}	protected int getActionCount() {		return getActionCount(getAllMultiModelActionFlag());	}	protected int getActionCount(boolean allAction) {		return allAction ? actionAllCount : actionCount;	}	protected void setActionCount(int i) {		setActionCount(i, getAllMultiModelActionFlag());	}	protected void setActionCount(int i, boolean allAction) {		if (allAction) {			actionAllCount = i;		} else {			actionCount = i;		}	}	protected float getActionTime() {		return getActionTime(getAllMultiModelActionFlag());	}	protected float getActionTime(boolean allAction) {		return allAction ? actionAllTime : actionTime;	}	protected void setActionTime(float f) {		setActionTime(f, getAllMultiModelActionFlag());	}	protected void setActionTime(float f, boolean allAction) {		if (allAction) {			actionAllTime = f;		} else {			actionTime = f;		}	}	protected float getActionSpeed() {		return getActionSpeed(getAllMultiModelActionFlag());	}	protected float getActionSpeed(boolean allAction) {		return allAction ? actionAllSpeed : actionSpeed;	}	protected void setActionSpeed(float f) {		setActionSpeed(f, getAllMultiModelActionFlag());	}	protected void setActionSpeed(float f, boolean allAction) {		if (allAction) {			actionAllSpeed = f;		} else {			actionSpeed = f;		}	}	protected boolean getMotionSetFlag() {		return motionSetFlag;	}	protected void setMotionSetFlag(boolean b) {		motionSetFlag = b;	}	protected int getSkinMode() {		return skinMode;	}	protected void setSkinMode(int i) {		skinMode = i;	}	protected byte getEntityType() {		return entityType;	}	protected void setEntityType(byte b) {		entityType = b;	}	protected boolean getOldwalking() {		return Modchu_CastHelper.Boolean(getFreeVariable("oldwalking"));	}	protected void setOldwalking(boolean b) {		setFreeVariable("oldwalking", b);	}	protected boolean getFirstPerson() {		return Modchu_CastHelper.Boolean(getFreeVariable("firstPerson"));	}	protected void setFirstPerson(boolean b) {		setFreeVariable("firstPerson", b);	}	protected Object getFreeVariable(String s) {		return freeVariableMap != null				&& freeVariableMap.containsKey(s) ? freeVariableMap.get(s) : null;	}	protected void setFreeVariable(String s, Object o) {		if (freeVariableMap != null); else freeVariableMap = new ConcurrentHashMap();		if (o != null) freeVariableMap.put(s, o);		else if (freeVariableMap.containsKey(s)) freeVariableMap.remove(s);	}	protected ConcurrentHashMap<String, Boolean> getDefaultShowPartsMap(int i) {		return ModchuModel_Config.getDefaultShowPartsMap(getTextureName(), i);	}	protected boolean getDefaultShowPartsMapBoolean(String s, int i) {		return ModchuModel_Config.getDefaultShowPartsMapBoolean(getTextureName(), s, i);	}	protected void putDefaultShowPartsMap(String s, int i, boolean b) {		ModchuModel_Config.putDefaultShowPartsMap(getTextureName(), s, i, b);	}	protected ConcurrentHashMap<String, Boolean> getShowPartsMap(int i) {		return ModchuModel_Config.getConfigShowPartsMap(getTextureName(), getMaidColor(), i);	}	protected int getShowPartsMapBoolean(String s, int i) {		return ModchuModel_Config.getConfigShowPartsMapBoolean(getTextureName(), s, getMaidColor(), i);	}	protected int getShowModelSettingBoolean(ModchuModel_ModelRenderer modelRenderer, int i) {		ConcurrentHashMap<ModchuModel_ModelRenderer, Boolean> modelRendererBooleanMap = (ConcurrentHashMap<ModchuModel_ModelRenderer, Boolean>) getCapsValue(caps_freeVariable, "modelRendererBooleanMap");		if (modelRendererBooleanMap != null); else modelRendererBooleanMap = new ConcurrentHashMap();		if (modelRendererBooleanMap.containsKey(modelRenderer)) return modelRendererBooleanMap.get(modelRenderer) ? 1 : 0;		int i1 = -1;		String textureName = getTextureName();		ConcurrentHashMap<String, Boolean> showPartsMap = ModchuModel_Config.getConfigShowPartsMap(textureName, getMaidColor(), i);		Object model = getModel(i);		if (model != null); else {			//Modchu_Debug.mDebug("getShowModelSettingBoolean model == null !!");			return i1;		}		ConcurrentHashMap<String, Field> modelRendererMap = ModchuModel_Config.getConfigModelRendererMap(model, textureName, i);		if (modelRendererMap != null); else return -1;		if (showPartsMap != null				&& !showPartsMap.isEmpty()) {			i1 = getShowModelSettingBoolean(modelRenderer, modelRendererMap, showPartsMap, i);		}		modelRendererBooleanMap.put(modelRenderer, i1 != 0 ? true : false);		setCapsValue(caps_freeVariable, "modelRendererBooleanMap", modelRendererBooleanMap);		return i1;	}	protected int getShowModelSettingBoolean(ModchuModel_ModelRenderer modelRenderer, ConcurrentHashMap<String, Field> modelRendererMap, ConcurrentHashMap<String, Boolean> map, int i) {		Object model = getModel(i);		if (model != null); else {			//Modchu_Debug.mDebug("getShowModelSettingBoolean model == null !!");			return -1;		}		Field f = null;		ModchuModel_ModelRenderer tempModelRenderer = null;		for (Entry<String, Boolean> en : map.entrySet()) {			String s2 = en.getKey();			boolean b = en.getValue();			if (modelRendererMap.containsKey(s2)) f = modelRendererMap.get(s2);			else f = null;			//Modchu_Debug.mDebug("getShowModelSettingBoolean s2="+s2+" b="+b);			if (f != null) {				//Modchu_Debug.mDebug("getShowModelSettingBoolean f != null");				try {					Object o = f.get(model);					tempModelRenderer = o != null ? (ModchuModel_ModelRenderer) o : null;					if (tempModelRenderer != null							&& tempModelRenderer.equals(modelRenderer)) {						return b ? 1 : 0;					}				} catch (Exception e) {					//e.printStackTrace();				}			}		}		return -1;	}	/**	 * GUI パーツ表示・非表示反映	 */	protected void showModelSettingReflects(int i) {		//Modchu_Debug.mDebug("showModelSettingReflects i="+i);		//boolean debug = true;		//if (debug) return;		ConcurrentHashMap<String, Boolean> showPartsMap = ModchuModel_Config.getConfigShowPartsMap(getTextureName(), getMaidColor(), i);		ConcurrentHashMap<String, Boolean> defaultShowPartsMap = getDefaultShowPartsMap(i);		Object model = getModel(i);		if (model != null); else {			//Modchu_Debug.mDebug("showModelSettingReflects model == null !!");			return;		}		String textureName = getTextureName();		ConcurrentHashMap<String, Field> modelRendererMap = ModchuModel_Config.getConfigModelRendererMap(model, textureName, i);		//Modchu_Debug.mDebug("showModelSettingReflects textureName="+textureName+" modelRendererMap != null ?"+(modelRendererMap != null));		if (modelRendererMap != null); else return;		if (defaultShowPartsMap != null) settingReflects(modelRendererMap, defaultShowPartsMap, null, null, i);		ConcurrentHashMap<String, Boolean> indexOfAllSetVisibleBooleanMap = ModchuModel_Config.getIndexOfAllSetVisibleBooleanMap(textureName, i);		if (showPartsMap != null				&& !showPartsMap.isEmpty()) settingReflects(modelRendererMap, showPartsMap, ModchuModel_Config.getIndexOfAllSetVisibleMap(textureName, i), indexOfAllSetVisibleBooleanMap, i);	}	protected void settingReflects(ConcurrentHashMap<String, Field> modelRendererMap, ConcurrentHashMap<String, Boolean> map,			ConcurrentHashMap<String, List<String>> indexOfAllSetVisibleMap, ConcurrentHashMap<String, Boolean> indexOfAllSetVisibleBooleanMap, int i) {		Object o = getModel(i);		if (o != null				&& o instanceof MultiModelBaseBiped); else {			//Modchu_Debug.mDebug("settingReflects o == null !!");			return;		}		MultiModelBaseBiped model = (MultiModelBaseBiped) o;		Field f = null;		ModchuModel_ModelRenderer modelRenderer = null;		for (Entry<String, Boolean> en : map.entrySet()) {			String s2 = en.getKey();			boolean b = en.getValue();			f = modelRendererMap.containsKey(s2) ? modelRendererMap.get(s2) : null;			//Modchu_Debug.mDebug("settingReflects s2="+s2+" b="+b);			if (f != null) {				//Modchu_Debug.mDebug("settingReflects f != null");				try {					Object o1 = f.get(model);					modelRenderer = o1 != null ? (ModchuModel_ModelRenderer) o1 : null;					if (modelRenderer != null) {						model.setCapsValue(null, caps_visible, modelRenderer, b, true);						if (ModchuModel_Main.ngPlayerModelList != null								&& !ModchuModel_Main.ngPlayerModelList.contains(getTextureName())) ModchuModel_Main.ngPlayerModelList.add(getTextureName());					}				} catch (Exception e) {					//e.printStackTrace();				}			}		}		if (indexOfAllSetVisibleMap != null				&& !indexOfAllSetVisibleMap.isEmpty()) {			for (Entry<String, List<String>> en : indexOfAllSetVisibleMap.entrySet()) {				String s2 = en.getKey();				List<String> list = en.getValue();				f = modelRendererMap.containsKey(s2) ? modelRendererMap.get(s2) : null;				//Modchu_Debug.mDebug("settingReflects indexOfAllSetVisibleMap s2="+s2);				if (f != null) {					//Modchu_Debug.mDebug("settingReflects indexOfAllSetVisibleMap f != null");					try {						Object o1 = f.get(model);						modelRenderer = o1 != null ? (ModchuModel_ModelRenderer) o1 : null;						if (modelRenderer != null) {							boolean b = modelRenderer.showModel;							for(String s3 : list) {								f = modelRendererMap.containsKey(s3) ? modelRendererMap.get(s3) : null;								//Modchu_Debug.mDebug("settingReflects indexOfAllSetVisibleList s2="+s2);								if (f != null) {									//Modchu_Debug.mDebug("settingReflects indexOfAllSetVisibleList f != null");									try {										o1 = f.get(model);										modelRenderer = o1 != null ? (ModchuModel_ModelRenderer) o1 : null;										if (modelRenderer != null) {											model.setCapsValue(null, caps_visible, modelRenderer, b, true);										}									} catch (Exception e) {									}								}							}						}					} catch (Exception e) {					}				}			}		}		if (indexOfAllSetVisibleBooleanMap != null				&& !indexOfAllSetVisibleBooleanMap.isEmpty()) {			for (Entry<String, Boolean> en : indexOfAllSetVisibleBooleanMap.entrySet()) {				String s2 = en.getKey();				boolean b = en.getValue();				for (Entry<String, Field> en2 : modelRendererMap.entrySet()) {					String s3 = en2.getKey();					f = en2.getValue();					if (s3.indexOf(s2) < 0) continue;					//Modchu_Debug.mDebug("settingReflects indexOfAllSetVisibleBooleanMap s3="+s3);					if (f != null) {						//Modchu_Debug.mDebug("settingReflects indexOfAllSetVisibleBooleanMap f != null");						try {							Object o1 = f.get(model);							modelRenderer = o1 != null ? (ModchuModel_ModelRenderer) o1 : null;							if (modelRenderer != null) {								model.setCapsValue(caps_visible, modelRenderer, b, true);							}						} catch (Exception e) {						}					}				}			}		}	}	/**	 * indexOfで検索対象のパーツをまとめて指定パーツと同じ状態にセットするListへの追加	 */	protected void indexOfAllSetVisible(String s, int i) {		Object model = getModel(i);		if (model != null); else {			//Modchu_Debug.mDebug("settingReflects model == null !!");			return;		}		if (model instanceof Object); else {			//Modchu_Debug.mDebug("settingReflects model != Object !!");			return;		}		Object model1 = model;		String textureName = getTextureName();		List<String> indexOfAllSetVisibleList = ModchuModel_Config.getIndexOfAllSetVisibleMap(textureName, s, i);		ConcurrentHashMap<String, Field> modelRendererMap = ModchuModel_Config.getConfigModelRendererMap(model1, textureName, i);		if (modelRendererMap != null				&& modelRendererMap.containsKey(s)); else return;		Field f = modelRendererMap.get(s);		if (f != null); else return;		try {			Object o = f.get(model1);			if (o != null); else return;			boolean b = ((ModchuModel_ModelRenderer) o).showModel;			for (Entry<String, Field> en : modelRendererMap.entrySet()) {				String s0 = en.getKey();				if (s0 != null						&& s0.indexOf(s) > -1) {					if (!indexOfAllSetVisibleList.contains(s0)							&& !s0.equals(s)) {						indexOfAllSetVisibleList.add(s0);						//Modchu_Debug.mDebug("indexOfAllSetVisible add s0="+s0);						ModchuModel_Config.setIndexOfAllSetVisibleMap(getTextureName(), s, i, indexOfAllSetVisibleList);					}				}			}		} catch (Exception e1) {			e1.printStackTrace();		}	}	/**	 * indexOfで検索対象のパーツをまとめて指定booleanにセットするListへの追加	 */	protected void indexOfAllSetVisible(String s, int i, boolean b) {		String textureName = getTextureName();		ConcurrentHashMap<String, Boolean> indexOfAllSetVisibleBooleanMap = ModchuModel_Config.getIndexOfAllSetVisibleBooleanMap(textureName, i);		indexOfAllSetVisibleBooleanMap.put(s, b);		ModchuModel_Config.setIndexOfAllSetVisibleBooleanMap(textureName, i, indexOfAllSetVisibleBooleanMap);/*		ConcurrentHashMap<Integer, String> nemeMap = ModchuModel_Config.getConfigShowPartsNemeMap(s, i);		Object model =  getModel(i);		ConcurrentHashMap<String, Field> modelRendererMap = ModchuModel_Config.getConfigModelRendererMap(model, textureName, i);		if (nemeMap != null); else return;		String s0 = null;		for(int i1 = 0; i1 < nemeMap.size(); i1++) {			s0 = nemeMap.get(i1);			if (s0.indexOf(s) > -1) {				try {					model.setCapsValue(caps_visible, (ModchuModel_ModelRenderer) modelRendererMap.get(s0).get(model), b);				} catch (Exception e) {					e.printStackTrace();				}			}		}*/	}	protected String getModelRendererName(ModchuModel_ModelRenderer modelRenderer, int i) {		ModchuModel_ModelRenderer modelRenderer2;		Object model = getModel(i);		if (model != null); else {			//Modchu_Debug.mDebug("getModelRendererName model == null !!");			return null;		}		Object o;		String textureName = getTextureName();		for (Entry<String, Field> en : ModchuModel_Config.getConfigModelRendererMap(model, textureName, i).entrySet()) {			String s = en.getKey();			Field f = en.getValue();			o = null;			//Modchu_Debug.mDebug("getModelRendererName s="+s);			try {				o = f.get(model);			} catch (Exception e) {				e.printStackTrace();			}			if (o != null) {				modelRenderer2 = (ModchuModel_ModelRenderer) o;				if (modelRenderer2.equals(modelRenderer)) {					return s;				}			}		}		return null;	}	private int getInitFlag() {		return initFlag;	}	private void setInitFlag(int i) {		initFlag = i;	}	private boolean getAllMultiModelActionModeCheck() {		switch(getAllMultiModelActionMode()) {		case 0:			return false;		case 1:			return true;		case 2:			return getCapsValueBoolean(caps_isPlayer) ? false : true;		}		return false;	}	protected Object getModel(int i) {		Object owner = getOwner();		if (owner != null); else {			return null;		}		int version = Modchu_Main.getMinecraftVersion();		boolean isLMMX = ModchuModel_Main.isLMMX;		Class c = Modchu_Reflect.loadClass(version < 170 ? "LMM_EntityLittleMaid" : isLMMX ? "littleMaidMobX.LMM_EntityLittleMaid" : "mmm.littleMaidMob.entity.EntityLittleMaidBase");		if (c != null				&& c.isInstance(owner)) {			if (version < 170					| isLMMX) {				Object textureData = Modchu_Reflect.getFieldObject(owner.getClass(), "textureData", owner);				if (textureData != null) {					Object[] textureModel = Modchu_CastHelper.ObjectArray(Modchu_Reflect.getFieldObject(textureData.getClass(), "textureModel", textureData));					if (textureModel != null) {						return textureModel != null								&& i < textureModel.length ? textureModel[i] : null;					} else {						Modchu_Debug.mDebug("ModchuModel_ModelDataBase getModel textureModel == null !!");					}				} else {					Modchu_Debug.mDebug("ModchuModel_ModelDataBase getModel textureData == null !!");				}			} else {				Object multiModel = Modchu_Reflect.getFieldObject(owner.getClass(), "multiModel", owner);				if (multiModel != null) {					Object[] model = Modchu_CastHelper.ObjectArray(Modchu_Reflect.getFieldObject(multiModel.getClass(), "model", multiModel));					if (model != null) {						Object[] models = Modchu_CastHelper.ObjectArray(Modchu_Reflect.invokeMethod(model.getClass(), "getModelClass", new Class[]{ int.class }, model, new Object[]{ getMaidColor() }));						return models != null								&& i < models.length ? models[i] : null;					}				}			}		} else {			Modchu_Debug.mDebug("ModchuModel_ModelDataBase getModel !c.isInstance owner="+owner);		}		return null;	}	protected String getTextureName() {		Object owner = getOwner();		int version = Modchu_Main.getMinecraftVersion();		Class c = version < 170 ? Modchu_Reflect.loadClass("LMM_EntityLittleMaid") : Modchu_Reflect.loadClass("mmm.littleMaidMob.entity.EntityLittleMaidBase");		if (c != null				&& c.isInstance(owner)) {			if (version > 169) {				Object multiModel = Modchu_Reflect.getFieldObject(owner.getClass(), "multiModel", owner);				if (multiModel != null) return Modchu_CastHelper.String(Modchu_Reflect.getFieldObject(multiModel.getClass(), "modelName", multiModel));			} else {				Object textureData = Modchu_Reflect.getFieldObject(owner.getClass(), "textureData", owner);				if (textureData != null) {					Object[] textureBox = Modchu_CastHelper.ObjectArray(Modchu_Reflect.getFieldObject(textureData.getClass(), "textureBox", textureData));					Class MMM_TextureBoxServer = Modchu_Reflect.loadClass("MMM_TextureBoxServer");					if (MMM_TextureBoxServer != null							&& MMM_TextureBoxServer.isInstance(textureBox[0])); else {						if (textureBox != null) return Modchu_CastHelper.String(Modchu_Reflect.getFieldObject("ModchuModel_TextureBoxBase", "textureName", textureBox[0], Modchu_Main.isRelease() ? -1 : 0));					}				}			}		}		return textureName;	}	protected void setTextureName(String s) {		Object owner = getOwner();		int version = Modchu_Main.getMinecraftVersion();		Class c = version < 170 ? Modchu_Reflect.loadClass("LMM_EntityLittleMaid") : Modchu_Reflect.loadClass("mmm.littleMaidMob.entity.EntityLittleMaidBase");		if (c != null				&& c.isInstance(owner)) {			if (version > 169) {				Object multiModel = Modchu_Reflect.getFieldObject(owner.getClass(), "multiModel", owner);				if (multiModel != null) Modchu_Reflect.setFieldObject(multiModel.getClass(), "modelName", multiModel, s);			} else {				Object textureData = Modchu_Reflect.getFieldObject(owner.getClass(), "textureData", owner);				if (textureData != null) {					Object[] textureBox = Modchu_CastHelper.ObjectArray(Modchu_Reflect.getFieldObject(textureData.getClass(), "textureBox", textureData));					Class MMM_TextureBoxServer = Modchu_Reflect.loadClass("MMM_TextureBoxServer");					if (MMM_TextureBoxServer != null							&& MMM_TextureBoxServer.isInstance(textureBox[0])); else {						if (textureBox != null) Modchu_Reflect.setFieldObject("ModchuModel_TextureBoxBase", "textureName", textureBox[0], s, Modchu_Main.isRelease() ? -1 : 0);					}				}			}			//else {				//Modchu_CastHelper.ObjectArray(Modchu_Reflect.getFieldObject("LMM_EntityLittleMaid", "textures", owner))[0] = s;			//}		}		textureName = s;	}	protected String getTextureArmorName() {		Object owner = getOwner();		int version = Modchu_Main.getMinecraftVersion();		Class c = version < 170 ? Modchu_Reflect.loadClass("LMM_EntityLittleMaid") : Modchu_Reflect.loadClass("mmm.littleMaidMob.entity.EntityLittleMaidBase");		if (c != null				&& c.isInstance(owner)) {			if (version > 169) {				Object multiModel = Modchu_Reflect.getFieldObject(owner.getClass(), "multiModel", owner);				if (multiModel != null) return Modchu_CastHelper.String(Modchu_Reflect.getFieldObject(multiModel.getClass(), "armorName", multiModel));			} else {				Object textureData = Modchu_Reflect.getFieldObject(owner.getClass(), "textureData", owner);				if (textureData != null) {					Object[] textureBox = Modchu_CastHelper.ObjectArray(Modchu_Reflect.getFieldObject(textureData.getClass(), "textureBox", textureData));					Class MMM_TextureBoxServer = Modchu_Reflect.loadClass("MMM_TextureBoxServer");					if (MMM_TextureBoxServer != null							&& MMM_TextureBoxServer.isInstance(textureBox[1])); else {						if (textureBox != null) return Modchu_CastHelper.String(Modchu_Reflect.getFieldObject(textureBox[1].getClass(), "textureName", textureBox[1], Modchu_Main.isRelease() ? -1 : 0));					}				}			}			//else {				//return Modchu_CastHelper.String(Modchu_CastHelper.ObjectArray(Modchu_Reflect.getFieldObject("LMM_EntityLittleMaid", "textureArmor1", owner))[0]);			//}		}		return modelArmorName;	}	protected void setTextureArmorName(String s) {		Object owner = getOwner();		int version = Modchu_Main.getMinecraftVersion();		Class c = version < 170 ? Modchu_Reflect.loadClass("LMM_EntityLittleMaid") : Modchu_Reflect.loadClass("mmm.littleMaidMob.entity.EntityLittleMaidBase");		if (c != null				&& c.isInstance(owner)) {			if (version > 169) {				Object multiModel = Modchu_Reflect.getFieldObject(owner.getClass(), "multiModel", owner);				if (multiModel != null) Modchu_Reflect.setFieldObject(multiModel.getClass(), "armorName", multiModel, s);			} else if (version > 159) {				Object textureData = Modchu_Reflect.getFieldObject(owner.getClass(), "textureData", owner);				if (textureData != null) {					Object[] textureBox = Modchu_CastHelper.ObjectArray(Modchu_Reflect.getFieldObject(textureData.getClass(), "textureBox", textureData));/*					Class MMM_TextureBoxServer = Modchu_Reflect.loadClass("MMM_TextureBoxServer");					if (MMM_TextureBoxServer != null							&& MMM_TextureBoxServer.isInstance(textureBox[1])); else {						if (textureBox != null) Modchu_Reflect.setFieldObject(textureBox[1].getClass(), "textureName", textureBox[1], s, Modchu_Main.isRelease() ? -1 : 0);					}*/				}			} else {			}		}		modelArmorName = s;	}	protected int getMaidColor() {		Object owner = getOwner();		int version = Modchu_Main.getMinecraftVersion();		Class c = version < 170 ? Modchu_Reflect.loadClass("LMM_EntityLittleMaid") : Modchu_Reflect.loadClass("mmm.littleMaidMob.entity.EntityLittleMaidBase");		if (c != null				&& c.isInstance(owner)) {			if (version > 169) {				Object multiModel = Modchu_Reflect.getFieldObject(owner.getClass(), "multiModel", owner);				if (multiModel != null) return Modchu_CastHelper.Int(Modchu_Reflect.getFieldObject(multiModel.getClass(), "color", multiModel));			} else if (version > 159) {				Object textureData = Modchu_Reflect.getFieldObject(owner.getClass(), "textureData", owner);				if (textureData != null) {					return Modchu_CastHelper.Int(Modchu_Reflect.getFieldObject(textureData.getClass(), "color", textureData));				}			} else {				return Modchu_CastHelper.Int(Modchu_Reflect.getFieldObject("LMM_EntityLittleMaid", "maidColor", owner));			}		}		return maidColor;	}	protected void setMaidColor(int i) {		Object owner = getOwner();		int version = Modchu_Main.getMinecraftVersion();		Class c = version < 170 ? Modchu_Reflect.loadClass("LMM_EntityLittleMaid") : Modchu_Reflect.loadClass("mmm.littleMaidMob.entity.EntityLittleMaidBase");		if (c != null				&& c.isInstance(owner)) {			if (version < 170) {				Object textureData = Modchu_Reflect.getFieldObject(owner.getClass(), "textureData", owner);				if (textureData != null) {					Modchu_Reflect.setFieldObject(textureData.getClass(), "color", textureData, i);				}			} else {				Object multiModel = Modchu_Reflect.getFieldObject(owner.getClass(), "multiModel", owner);				if (multiModel != null) Modchu_Reflect.setFieldObject(multiModel.getClass(), "color", multiModel, i);			}		}		maidColor = i;	}	public static int getAllMultiModelActionRequestNumber() {		return allMultiModelActionRequestNumber;	}	public static void setAllMultiModelActionRequestNumber(int i) {		allMultiModelActionRequestNumber = i;	}	public static int getAllMultiModelActionMode() {		return allMultiModelActionMode;	}	public static int getAllMultiModelActionMax() {		return allMultiModelActionMax;	}	public static void setAllMultiModelActionModePlus() {		allMultiModelActionMode++;		if (allMultiModelActionMode > allMultiModelActionModeMax) allMultiModelActionMode = 0;		return;	}	public static void setAllMultiModelActionModeMinus() {		allMultiModelActionMode--;		if (allMultiModelActionMode < 0) allMultiModelActionMode = allMultiModelActionModeMax;		return;	}	public static void setAllMultiModelActionPlus() {		allMultiModelActionRequestNumber++;		if (allMultiModelActionRequestNumber > allMultiModelActionMax) allMultiModelActionRequestNumber = 0;		return;	}	public static void setAllMultiModelActionMinus() {		allMultiModelActionRequestNumber--;		if (allMultiModelActionRequestNumber < 0) allMultiModelActionRequestNumber = allMultiModelActionMax;		return;	}	public static void setAllMultiModelActionMode(int i) {		allMultiModelActionMode = i;		if (allMultiModelActionMode > allMultiModelActionModeMax				| allMultiModelActionMode < 0) allMultiModelActionMode = 0;		return;	}	public static int getAllMultiModelActionModeMax() {		return allMultiModelActionModeMax;	}	public static boolean getAllMultiModelActionFlag() {		return allMultiModelActionFlag;	}	public static void setAllMultiModelActionFlag(boolean b) {		allMultiModelActionFlag = b;	}	public static String getAllMultiModelActionModeName(int i) {		String s = null;		switch (i) {		case 0:			s = "false";			break;		case 1:			s = "All";			break;		case 2:			s = "PlayersOther";			break;		}		return s;	}	protected boolean getAllMultiModelActionRunInitFlag() {		return allMultiModelActionRunInitFlag;	}	protected void setAllMultiModelActionRunInitFlag(boolean b) {		allMultiModelActionRunInitFlag = b;	}	protected Object getOwner() {		if (subEntityCaps != null) return Modchu_Reflect.getFieldObject(subEntityCaps.getClass(), "owner", subEntityCaps, -1);		return owner;	}	protected boolean isEntityPlayer(Object entity) {		return entity != null				&& Modchu_Reflect.loadClass("EntityPlayer").isInstance(entity);	}	protected List<String> getShowPartsHideList() {		return showPartsHideList;	}	/**	 * GUI パーツ表示・非表示用 ボタン非表示リスト追加	 */	protected void addShowPartsHideList(String[] s) {		//Modchu_Debug.mDebug("addShowPartsHideList s.length="+s.length);		for(int i = 0; i < s.length; i++) {			showPartsHideList.add(s[i]);		}	}	protected ConcurrentHashMap<String, String> getShowPartsRenemeMap() {		return showPartsRenemeMap;	}	/**	 * GUI パーツ表示・非表示用 ボタン表示名リネーム用追加	 */	protected void addShowPartsRenemeMap(String[] s1, String[] s2) {		for(int i = 0; i < s1.length && i < s2.length; i++) {			showPartsRenemeMap.put(s1[i], s2[i]);		}	}	private Object getTexture(String s, int i) {		return ModchuModel_TextureManagerBase.instance.textureManagerGetTexture(s, i);	}	private Object getArmorTexture(String s, int i) {		return getArmorTexture(s, i, null);	}	private Object getArmorTexture(String s, int i, String s1) {		return ModchuModel_TextureManagerBase.instance.textureManagerGetArmorTexture(s, i, Modchu_Reflect.newInstance("ItemStack", new Class[]{ Modchu_Reflect.loadClass("Item") }, new Object[]{ Modchu_AS.get(Modchu_AS.getItem, s1 != null && !s1.isEmpty() ? s1 : "diamond_helmet") }));	}	private Object getArmorTexture(String s, int i, Object itemStackOrString) {		if (itemStackOrString != null); else itemStackOrString = Modchu_Reflect.newInstance("ItemStack", new Class[]{ Modchu_Reflect.loadClass("Item") }, new Object[]{ Modchu_AS.get(Modchu_AS.getItem, "diamond_helmet") });		return itemStackOrString instanceof String ? getArmorTexture(s, i, (String) itemStackOrString) : ModchuModel_TextureManagerBase.instance.textureManagerGetArmorTexture(s, i, itemStackOrString, true);	}	public int getCapsValueInt(int pIndex, Object ...pArg) {		Object o = getCapsValue(null, pIndex, pArg);		if (o instanceof Boolean) {			boolean b = (Boolean) o;			return b ? 2 : 1;		}		return o != null ? (Integer) o : 0;	}	public float getCapsValueFloat(int pIndex, Object ...pArg) {		Object o = getCapsValue(null, pIndex, pArg);		return o != null ? (Float) o : 0.0F;	}	public double getCapsValueDouble(int pIndex, Object ...pArg) {		Object o = getCapsValue(null, pIndex, pArg);		return o != null ? (Double) o : 0.0D;	}	public boolean getCapsValueBoolean(int pIndex, Object ...pArg) {		Object o = getCapsValue(null, pIndex, pArg);		return o != null ? (Boolean) o : false;	}	public boolean[] getCapsValueBooleanArray(int pIndex, Object ...pArg) {		Object o = getCapsValue(null, pIndex, pArg);		return o != null ? (boolean[]) o : null;	}}